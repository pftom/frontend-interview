## 进程和线程


**问：简单地讲一下什么是进程和线程，它们之间的区别？**


- 进程是资源分配的最小单位，线程是CPU调度的最小单位
- 进程**有自己的独立地址空间，同一进程的所有线程则是共享内存**（这也是导致进程切换成本高的原因）
- 一个线程只能属于一个进程，而一个进程可以有多个线程，但至少有一个线程。**线程是操作系统可识别的最小执行和调度单位**
- 生动比喻：进程=火车，线程=车厢 

 
**问：进程之间的通信方式有哪些？**

- **管道**：管道是单向的、先进先出的、无结构的、固定大小的字节流，它把一个进程的标准输出和另一个进程的标准输入连接在一起
- **信号量**：信号量是一个计数器，可以用来控制多个进程对共享资源的访问。它常作为一种锁机制，防止某进程正在访问共享资源时，其它进程也访问该资源。
- **消息队列**：是一个在系统内核中用来保存消 息的队列，它在系统内核中是以消息链表的形式出现的。消息队列克服了信号传递信息少、管道只能承载无格式字节流以及缓冲区大小受限等缺点
- **共享内存**：共享内存允许两个或多个进程访问同一个逻辑内存。**这一段内存可以被两个或两个以上的进程映射至自身的地址空间中**，一个进程写入共享内存的信息，可以被其他使用这个共享内存的进程，通过一个简单的内存读取读出，从而实现了进程间的通信**。**
- **套接字**：套接字也是一种进程间通信机制，与其它通信机制不同的是，它可用于不同机器间的进程通信



**问：线程之间的同步方式有哪些？**


- **互斥量**：采用互斥对象机制，只有拥有互斥对象的线程才有访问公共资源的权限。因为互斥对象只有一个，所以可以保证公共资源不会被多个线程同时访问。
- **信号量**：它允许同一时刻多个线程访问同一资源，但是需要控制同一时刻访问此资源的最大线程数量。
- **事件（信号）**：通过通知操作的方式来保持多线程同步，还可以方便的实现多线程优先级的比较操作。



**问：什么是进程的同步？需要遵循哪些原则？**


- 进程的同步是对多个相关进程在执行次序上进行协调，以使并发执行的诸进程之间能有效地共享资源和相互合作，从而使程序的执行具有可再现性
- 应当遵循四个原则：**空闲让进**，**忙则等待**（保证对临界区的互斥访问），**有限等待**（有限代表有限的时间，避免死等），**让权等待**（当进程不能进入自己的临界区时，应该释放处理机，以免陷入忙等状态）



**问：进程有哪些常见的状态？各种状态之间如何转换？**


- **就绪**：进程已处于准备好运行的状态，即进程已分配到除CPU外的所有必要资源后，只要再获得CPU，便可立即执行。
- **执行**：进程已经获得CPU，程序正在执行状态。
- **阻塞**：正在执行的进程由于发生某事件（如I/O请求、申请缓冲区失败等）暂时无法继续执行的状态。
- 转换关系如下图所示



![image.png](https://cdn.nlark.com/yuque/0/2020/png/125564/1592652935938-5498e1d7-9f16-4fd4-8fb1-f66e57ad29b3.png#align=left&display=inline&height=178&margin=%5Bobject%20Object%5D&name=image.png&originHeight=180&originWidth=319&size=34032&status=done&style=none&width=315)

**问：什么是线程池？**


- 池化技术的概念：提前保存大量的资源（例如线程），以备不时之需以及重复使用
- 当程序中需要频繁的进行内存申请释放，进程、线程创建销毁等操作时，通常会使用内存池、进程池、线程池技术来提升程序的性能
- 具体原理：先启动若干数量的线程，并让这些线程都处于睡眠状态，当需要一个开辟一个线程去做具体的工作时，就会唤醒线程池中的某一个睡眠线程，让它去做具体工作，当工作完成后，线程又处于睡眠状态，而不是将线程销毁



## 进程的调度


**问：进程的调度有哪些种类？**

- **高级调度**：(High-Level Scheduling)又称为作业调度，它决定把后备作业调入内存运行
- **低级调度**：(Low-Level Scheduling)又称为进程调度，它决定把就绪队列的某进程获得CPU
- **中级调度**：(Intermediate-Level Scheduling)又称为在虚拟存储器中引入，在内、外存对换区进行进程对换



**问：说一说进程的非抢占式调度与抢占式调度？**
**

- **非抢占式**：分派程序一旦把处理机分配给某进程后便让它一直运行下去，直到进程完成或发生进程调度进程调度某事件而阻塞时，才把处理机分配给另一个进程
- **抢占式**：操作系统将正在运行的进程强行暂停，由调度程序将CPU分配给其他就绪进程的调度方式



**问：进程的调度有哪些策略/算法？**


- **FIFO或First Come, First Served (FCFS)先来先服务**
- **Shortest Job First (SJF)：**可以保证最小的平均等待时间，但是会导致长作业饥饿
- **Shortest Remaining Job First (SRJF)：**SJF的可抢占版本，比SJF更有优势
- **优先权调度：**容易导致低优先权的进程饥饿
- **Round-Robin(RR)轮转调度算法：**设置一个时间片，按时间片来轮转调度（“轮叫”算法）
- **多级队列调度：**按照一定的规则建立多个进程队列，不同的队列有固定的优先级（高优先级有抢占权）
- **（最通用）多级反馈队列：**在多级队列的基础上，任务可以在队列之间移动，更细致的区分任务



## 同步和互斥


**问：讲一下线程之间如何同步？**


- 线程间的同步方法大体可分为两类：用户模式和内核模式。
- 内核模式就是指利用系统内核对象的单一性来进行同步，使用时需要切换内核态与用户态，而用户模式就是不需要切换到内核态，只在用户态完成操作。
- 用户模式下的方法有：原子操作（例如一个单一的全局变量），临界区。
- 内核模式下的方法有：事件，信号量，互斥量。



## 并发和并行


**问：讲一下并发和并行的区别？**


- 并发不是并行，而是让并行成为可能，一个是“如何处理”，一个是“如何执行”（Rob Pike）
- 例如我们写了一个多线程的并发引用，但是 CPU 只有单核，那么就不是并行，只有在多核情况下才是并行；只并行不并发：多个无关的程序运行在不同的核心上，就像路人一样



**问：什么是线程安全？**


如果多线程的程序运行结果是可预期的，而且与单线程的程序运行结果一样，那么说明是“线程安全”的。


**问：什么是高并发？**


让软件系统在一段时间内能够处理大量的请求。


## 内存


**问：什么是虚拟内存？**


具有请求调入功能和置换功能，能从逻辑上对内存容量加以扩充得一种存储器系统。

**问：内存碎片分为哪几种？**

- 分为内部碎片和外部碎片
- **内部碎片**是已经被分配出去的的内存空间大于请求所需的内存空间。
- **外部碎片**是指还没有分配出去，但是由于大小太小而无法分配给申请空间的新进程的内存空间空闲块。



## 死锁


**问：什么是死锁？**


两个或多个进程被无限期地阻塞、相互等待的一种状态。


**问：产生死锁有哪些必要条件？**


- **互斥条件(Mutual exclusion)**：资源不能被共享，只能由一个进程使用。
- **请求与保持条件(Hold and wait)**：已经得到资源的进程可以再次申请新的资源。
- **非抢占条件(No pre-emption)**：已经分配的资源不能从相应的进程中被强制地剥夺。
- **循环等待条件(Circular wait)**：系统中若干进程组成环路，该环路中每个进程都在等待相邻进程正占用的资源。



**问：如何处理死锁？**


- **检测死锁并且恢复。**
- 仔细地对资源进行动态分配，使系统始终处于安全状态以**避免死锁**。
- **通过破除死锁四个必要条件之一，来防止死锁产生。**



## 用户态和核心态


**问：什么是用户态和核心态，两者的区别是什么？**


- 用户态的进程能存取它们自己的指令和数据，但不能存取内核指令和数据（或其他进程的指令和数据）
- 核心态下的进程能够存取内核和用户地址
- 两者的区别主要就是权限不同



**问：哪些情况下会从用户态切换到核心态？**


- **系统调用**：程序的执行一般是在用户态下执行的，但当程序需要使用操作系统提供的服务时，比如说打开某一设备、创建文件、读写文件（这些均属于系统调用）等，就需要向操作系统发出调用服务的请求
- **异常**：当CPU在执行运行在用户态下的程序时，发生了某些事先不可知的异常，这时会触发由当前运行进程切换到处理此异常的内核相关程序中，也就转到了内核态，比如缺页异常。
- **外围设备的中断：**当外围设备完成用户请求的操作后，会向CPU发出相应的中断信号，这时CPU会暂停执行下一条即将要执行的指令转而去执行与中断信号对应的处理程序，如果先前执行的指令是用户态下的程序，那么这个转换的过程自然也就发生了由用户态到内核态的切换。比如硬盘读写操作完成，系统会切换到硬盘读写的中断处理程序中执行后续操作等



## 中断


**问：什么是操作系统的中断？ **


所谓的中断就是在计算机执行程序的过程中，由于出现了某些特殊事情，使得CPU暂停对程序的执行，转而去执行处理这一事件的程序。等这些特殊事情处理完之后再回去执行之前的程序。
**
**问：中断有哪些类别？**
**

- **内部异常中断：**由计算机硬件异常或故障引起的中断
- **软中断：**由程序中执行了引起中断的指令而造成的中断
- **外部中断：**由外部设备请求引起的中断



**问：什么是中断的优先级？**


- 中断的优先级说明的是当一个中断正在被处理的时候，处理器能接受的中断的级别。
- 每个中断都有一个对应的优先级，当处理器在处理某一中断的时候，只有比这个中断优先级高的中断可以被处理器接受并且被处理。
- 典型的优先级：机器错误 > 时钟 > 磁盘 > 网络设备 > 终端 > 软件中断



## 页面置换算法


**问：什么是页面置换算法？**


- 操作系统将内存按照页面进行管理，在需要的时候才把进程相应的部分调入内存。
- 当产生缺页中断时，需要选择一个页面写入。
- 如果要换出的页面在内存中被修改过，变成了“脏”页面，那就需要先写会到磁盘。
- 页面置换算法，就是要选出最合适的一个页面，使得置换的效率最高。




**问：有哪些页面置换算法？**


- 先进先出页面置换算法（FIFO）及其改进
- 最近最少使用页面置换算法LRU（Least Recently Used）
- （好像还有 LFU）
## 协程（后端需要关注）


**问：什么是协程？**


协程，是在应用层模拟的线程，他避免了上下文切换的额外耗费，兼顾了多线程的优点。简化了高并发程序的复杂度。


## 参考资料


- [操作系统面试题目总结](https://zhuanlan.zhihu.com/p/86629244)
- [操作系统常见面试题](https://www.cnblogs.com/inception6-lxc/p/9073983.html)
- [常见面试题整理（操作系统）](https://blog.csdn.net/gui951753/article/details/79489748)
- [【面试高频问题】线程、进程、协程](https://zhuanlan.zhihu.com/p/70256971)
